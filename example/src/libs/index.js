import e,{useState as t,useCallback as n}from"react";import o from"react-tooltip";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var r=function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},i={BLUE:"#4d8af0",RED:"#cc3333",GREEN:"#2e8f59",YELLOW:"#a3a328"},a=function(e,t){var n=parseInt(e.replace("#",""),16),o=Math.round(2.55*t),r=(n>>16)+o,i=(n>>8&255)+o,a=(255&n)+o;return"#"+(16777216+65536*(r<255?r<1?0:r:255)+256*(i<255?i<1?0:i:255)+(a<255?a<1?0:a:255)).toString(16).slice(1)},l=function(e,t){var n=t.color,o=t.diffPercentage,r=void 0===o?3:o,l=n.startsWith("#")?n:function(e){return(e=e.toUpperCase())in i?i[e]:i.BLUE}(n),u=e[0];u.color||(u.color=l,l=a(l,r));for(var c=1;c<e.length;c++)e[c].color||(e[c].color=l,l=a(l,r));return e},u=0,c=e.memo((function(t){var n=t.center,o=t.data,r=t.onHover,i=t.expandSize,a=t.strokeWidth,l=t.strokeColor,c=t.strokeLinejoin,s=t.transitionTimingFunction,d=t.transitionDuration,v=o.reduce((function(e,t){return t.value+e}),0),f=function(e,t){return function(n){r(e,t,n)}};return v<1?null:o.map((function(t,r){var p=n+(t.hovered?i:0)-a/2,m=function(e){var t=e.total,n=e.radius,o=e.value,r=e.center,i=Number((o/t*360*Math.PI/180).toFixed(4)),a=(r+Math.sin(i)*n).toFixed(4),l=(r-Math.cos(i)*n).toFixed(4);return"\n          M"+r+" "+r+",\n          L"+r+" "+(r-n)+",\n          A"+n+" "+n+",\n          0 "+(i>Math.PI?1:0)+" 1,\n          "+a+" "+l+"Z"}({total:v,radius:p,value:t.value,center:n}),h=(u/v*360).toFixed(4);u+=t.value;var x=1===o.length;return e.createElement("g",{key:"pie"+r,transform:"rotate("+h+", "+n+", "+n+")"},x?e.createElement("circle",{cx:n,cy:n,r:p,fill:t.color}):e.createElement("path",{d:m,fill:t.color,stroke:l,strokeWidth:a,strokeLinejoin:c,onMouseEnter:f(t,r),onMouseLeave:f(null,null),onTouchStart:f(t,r),onTouchEnd:f(null,null),style:{transitionProperty:"all",transitionTimingFunction:s,transitionDuration:d}}))}))})),s=e.memo((function(t){return e.createElement("div",null,t.data.title,": ",e.createElement("b",null,t.data.percentage,"%"))})),d=function(i){var a=i.data,u=i.viewBoxSize,s=t(),d=s[0],v=s[1],f=i.viewBoxSize/2,p=i.expandOnHover?i.expandSize:0,m=function(e,t,n){var o=e.filter((function(e){return e.value>0})).sort((function(e,t){return t.value-e.value})),i=e.reduce((function(e,t){return t.value+e}),0);return o.length&&t?o.map((function(e,t){var o=(15.91549430919*Number((e.value/i*360*Math.PI/180).toFixed(4))).toFixed(2);return r(r({},e),{hovered:t===n,percentage:o})})):o}(a,i.expandOnHover,d);i.colorTone&&(m=l(m,i.colorTone));var h=n((function(){if(i.showTooltip&&m[d]){var t=m[d],n=i.CustomTooltipTemplate;return e.createElement(n,{data:t})}return null}),[d]);return m&&m.length>0?e.createElement(e.Fragment,null,e.createElement("svg",{"data-tip":"","data-for":"tooltip",viewBox:"0 0 "+(u+2*p)+" "+(u+2*p)},e.createElement("g",{transform:"translate("+p+", "+p+")"},e.createElement(c,{center:f,data:m,onHover:function(e,t,n){i.expandOnHover&&v(t),i.onPieHover&&i.onPieHover(e,t,n)},expandSize:i.expandSize,strokeColor:i.strokeColor,strokeLinejoin:i.strokeLinejoin,strokeWidth:i.strokeWidth,transitionDuration:i.transitionDuration,transitionTimingFunction:i.transitionTimingFunction}))),e.createElement(o,{id:"tooltip",getContent:h})):null};d.defaultProps={viewBoxSize:100,expandOnHover:!0,expandSize:3,onPieHover:function(){},shrinkOnTouchEnd:!1,strokeColor:"#fff",strokeLinejoin:"round",strokeWidth:0,transitionDuration:"0s",transitionTimingFunction:"ease-out",showTooltip:!0,CustomTooltipTemplate:s};var v=e.memo(d);export{v as PieChart};
